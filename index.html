<html>
  <head>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
  </head>
  <body>
    <h1>Steelers Watchface Configuration</h1>

    <label>
      Enable Animation
      <input id="AppKeyAnimations" type="checkbox" />
    </label>

    <input id="submit_button" type="button" value="Done" />
  </body>
  <script>
    // Get a handle to the button's HTML element
  var submitButton = document.getElementById('submit_button');

  function getQueryParam(variable, defaultValue) {
    var query = location.search.substring(1);
    var vars = query.split('&');
    for (var i = 0; i < vars.length; i++) {
      var pair = vars[i].split('=');
      if (pair[0] === variable) {
        return decodeURIComponent(pair[1]);
      }
    }
    return defaultValue || false;
  }

  // Add a 'click' listener
  submitButton.addEventListener('click', function() {
    // Get the config data from the UI elements
    var animationsCheckbox = document.getElementById('AppKeyAnimations');

    // Make a data object to be sent, coercing value types to integers
    var options = {
      'AppKeyAnimations': animationsCheckbox.checked ? 1 : 0
    };

    // Determine the correct return URL (emulator vs real watch)
    var return_to = getQueryParam('return_to', 'pebblejs://close#');

    // Encode and send the data when the page closes
    document.location = return_to + encodeURIComponent(JSON.stringify(options));
  });

  $(document).ready(function() {
    var animationsCheckbox = document.getElementById('AppKeyAnimations').checked = getQueryParam('AppKeyAnimations', true);
  });
</script>
</html>
